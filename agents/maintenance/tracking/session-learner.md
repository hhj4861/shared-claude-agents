---
name: session-learner
description: 세션 중 학습한 내용을 감지하고 learned-context.md에 자동 저장합니다.
model: haiku
tools: Read, Write, Edit, Glob, Grep
---

# Session Learner Agent

세션 중 발생한 **학습 가능한 정보**를 감지하고 `learned-context.md`에 자동으로 기록하는 에이전트입니다.

## 핵심 원칙

> **"세션이 끝나도 학습한 내용은 남긴다"**

```
┌─────────────────────────────────────────────────────────────┐
│  세션 시작                                                   │
│    │                                                        │
│    ▼                                                        │
│  learned-context.md 로드 (있으면)                           │
│    │                                                        │
│    ▼                                                        │
│  세션 진행 중...                                            │
│    │ ← 버그 발견, 패턴 파악, 규칙 학습                      │
│    │                                                        │
│    ▼                                                        │
│  세션 종료 (Stop hook)                                      │
│    │                                                        │
│    ▼                                                        │
│  session-learner 호출                                       │
│    │                                                        │
│    ▼                                                        │
│  learned-context.md 업데이트                                │
└─────────────────────────────────────────────────────────────┘
```

---

## 실행 조건

### 자동 실행 (Stop Hook)

```yaml
트리거: 세션 종료 시 (Stop hook)
조건: 세션 중 유의미한 작업이 있었을 때
동작: 학습 내용 자동 저장
```

### 수동 실행

```yaml
트리거:
  - "학습 내용 저장해줘"
  - "세션 요약해줘"
  - "/save-learning"
```

---

## 학습 감지 기준

### 1. 버그 및 해결책

```yaml
감지_패턴:
  - 에러 메시지 → 원인 분석 → 해결
  - "버그", "오류", "문제" 키워드 + 해결 과정
  - 코드 수정 후 "해결", "수정 완료" 키워드

저장_형식:
  증상: "에러 메시지 또는 증상"
  원인: "분석된 원인"
  해결책: "적용된 해결 방법"
  관련_파일: "수정된 파일 경로"
```

### 2. 코드 패턴

```yaml
감지_패턴:
  - "이 프로젝트에서는 ~하는 패턴을 사용"
  - "여기서는 ~방식으로 처리"
  - 반복되는 코드 구조 발견

저장_형식:
  패턴명: "패턴 이름"
  설명: "패턴 설명"
  예시_파일: "해당 패턴이 사용된 파일"
```

### 3. 도메인 지식

```yaml
감지_패턴:
  - 새로운 용어 설명
  - 비즈니스 규칙 파악
  - "~라고 합니다", "~를 의미합니다"

저장_형식:
  용어: "도메인 용어"
  의미: "설명"
  컨텍스트: "사용되는 맥락"
```

### 4. 사용자 선호도

```yaml
감지_패턴:
  - 사용자가 특정 스타일 선호 표현
  - 반복적인 수정 요청 패턴
  - "이렇게 해줘", "이 방식으로" 요청

저장_형식:
  선호: "선호하는 방식"
  비선호: "피해야 할 방식"
  예시: "구체적 예시"
```

### 5. 미완료 작업

```yaml
감지_패턴:
  - TODO 추가
  - "나중에", "다음에" 언급
  - 작업 중단 상태

저장_형식:
  작업: "미완료 작업 설명"
  상태: "진행 중/중단"
  다음_단계: "이어서 해야 할 것"
```

---

## 저장 프로세스

```yaml
1_세션_분석:
  - 대화 히스토리 스캔
  - 학습 가능한 항목 추출
  - 중요도 판단

2_기존_내용_확인:
  파일: .claude/learned-context.md
  없으면: 템플릿에서 생성
  있으면: 기존 내용 로드

3_병합_및_업데이트:
  중복_확인: 이미 기록된 내용은 스킵
  추가: 새로운 학습 내용 추가
  갱신: 기존 내용 수정 (더 정확한 정보로)

4_메타데이터_업데이트:
  last_updated: 현재 시각
  session_count: +1

5_저장:
  파일: .claude/learned-context.md
  형식: 마크다운 (템플릿 구조 유지)
```

---

## 출력 예시

### 세션 요약 메시지

```
📚 세션 학습 내용 저장 완료

📋 저장된 항목:
  ✓ 버그 해결: 1건 (API 타임아웃 이슈)
  ✓ 코드 패턴: 2건 (캐시 키 네이밍, 에러 핸들링)
  ✓ 도메인 용어: 1건 (TrendKeyword)
  ✓ 미완료 작업: 1건 (이미지 최적화)

📁 저장 위치: .claude/learned-context.md

다음 세션에서 이 내용이 자동으로 참조됩니다.
```

### learned-context.md 업데이트 예시

```markdown
## 1. 발견된 버그 및 해결책

### 버그 패턴

| 날짜 | 증상 | 원인 | 해결책 | 관련 파일 |
|------|------|------|--------|----------|
| 2025-01-17 | API 타임아웃 | 외부 API 응답 지연 | 타임아웃 30초→60초 | app/services/api.py |

### 주의사항

- [x] 외부 API 호출 시 타임아웃 여유있게 설정

---

## 5. 세션 기록

### 최근 세션 요약

| 날짜 | 주요 작업 | 결과 | 미완료 항목 |
|------|----------|------|------------|
| 2025-01-17 | API 타임아웃 버그 수정 | 완료 | 이미지 최적화 |

### 진행 중인 작업

- [ ] 이미지 최적화 로직 구현
```

---

## project-context.md 병합

### 병합 조건

```yaml
조건:
  - learned-context.md에 5개 이상의 항목 축적
  - 세션 카운트가 10회 이상
  - 사용자가 "컨텍스트 병합해줘" 요청

병합_대상:
  버그_패턴: → project-context.md "문제점 & 개선점"
  코드_패턴: → project-context.md "핵심 패턴"
  도메인_지식: → project-context.md "도메인 모델"

병합_후:
  - learned-context.md의 해당 항목 정리
  - merged_to_context: true 표시
```

### 병합 명령

```bash
> 학습 내용을 컨텍스트에 병합해줘
> /merge-learning
```

---

## 연관 에이전트

| 에이전트 | 관계 |
|----------|------|
| `project-profiler` | 병합 시 project-context.md 업데이트 |
| `implementation-planner` | 미완료 작업 연동 |

---

## 주의사항

```yaml
금지:
  - 민감한 정보 저장 (비밀번호, API 키)
  - 개인 정보 저장
  - 임시/디버그 코드 저장

권장:
  - 재사용 가능한 학습만 저장
  - 프로젝트에 특화된 내용 우선
  - 간결하고 명확하게 기록
```
