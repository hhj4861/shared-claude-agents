<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QA ì‹œë‚˜ë¦¬ì˜¤ ìƒì„± ì„¤ì •</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
      color: white;
      padding: 24px 32px;
    }

    .header h1 {
      font-size: 24px;
      font-weight: 600;
    }

    .header p {
      margin-top: 8px;
      opacity: 0.8;
      font-size: 14px;
    }

    .form-content {
      padding: 32px;
    }

    .section {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 16px;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background: #667eea;
      border-radius: 2px;
    }

    .input-group {
      margin-bottom: 16px;
    }

    .input-group label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: #4a5568;
      margin-bottom: 6px;
    }

    .input-group input[type="text"] {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .input-group input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .radio-group {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .radio-option:hover {
      border-color: #667eea;
      background: #f7fafc;
    }

    .radio-option input[type="radio"] {
      accent-color: #667eea;
    }

    .radio-option.selected {
      border-color: #667eea;
      background: #ebf4ff;
    }

    .doc-list {
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      overflow: hidden;
    }

    .doc-category {
      border-bottom: 1px solid #e2e8f0;
    }

    .doc-category:last-child {
      border-bottom: none;
    }

    .doc-category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: #f7fafc;
      cursor: pointer;
    }

    .doc-category-header:hover {
      background: #edf2f7;
    }

    .doc-category-title {
      font-weight: 500;
      color: #2d3748;
    }

    .add-btn {
      padding: 6px 12px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .add-btn:hover {
      background: #5a67d8;
    }

    .doc-items {
      padding: 12px 16px;
      display: none;
    }

    .doc-items.open {
      display: block;
    }

    .doc-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: #f7fafc;
      border-radius: 6px;
      margin-bottom: 8px;
    }

    .doc-item:last-child {
      margin-bottom: 0;
    }

    .doc-item input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      font-size: 13px;
    }

    .doc-item input:focus {
      outline: none;
      border-color: #667eea;
    }

    .remove-btn {
      padding: 6px 10px;
      background: #fc8181;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }

    .remove-btn:hover {
      background: #f56565;
    }

    .empty-message {
      color: #a0aec0;
      font-size: 13px;
      font-style: italic;
    }

    .submit-section {
      padding: 24px 32px;
      background: #f7fafc;
      border-top: 1px solid #e2e8f0;
    }

    .submit-btn {
      width: 100%;
      padding: 16px 32px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    .submit-btn:disabled {
      background: #a0aec0;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .success-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .success-overlay.show {
      display: flex;
    }

    .success-modal {
      background: white;
      padding: 40px;
      border-radius: 16px;
      text-align: center;
      max-width: 400px;
    }

    .success-icon {
      width: 64px;
      height: 64px;
      background: #48bb78;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      color: white;
      font-size: 32px;
    }

    .success-modal h2 {
      color: #2d3748;
      margin-bottom: 12px;
    }

    .success-modal p {
      color: #718096;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>QA ì‹œë‚˜ë¦¬ì˜¤ ìƒì„± ì„¤ì •</h1>
      <p>í”„ë¡œì íŠ¸ ì •ë³´ì™€ ì°¸ì¡° ë¬¸ì„œë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.</p>
    </div>

    <form id="configForm">
      <div class="form-content">
        <!-- í”„ë¡œì íŠ¸ ê²½ë¡œ -->
        <div class="section">
          <h2 class="section-title">í”„ë¡œì íŠ¸ ê²½ë¡œ</h2>
          <div class="input-group">
            <label for="bePath">ë°±ì—”ë“œ í”„ë¡œì íŠ¸ ê²½ë¡œ *</label>
            <input type="text" id="bePath" name="be_path" placeholder="/path/to/backend-project" required>
          </div>
          <div class="input-group">
            <label for="fePath">í”„ë¡ íŠ¸ì—”ë“œ í”„ë¡œì íŠ¸ ê²½ë¡œ (E2E í…ŒìŠ¤íŠ¸ ì‹œ)</label>
            <input type="text" id="fePath" name="fe_path" placeholder="/path/to/frontend-project (ë¹„ì›Œë‘ë©´ API í…ŒìŠ¤íŠ¸ë§Œ)">
          </div>
          <p style="font-size: 12px; color: #718096; margin-top: 8px;">
            ğŸ’¡ BE/FE ê²½ë¡œê°€ ë™ì¼í•˜ë©´ ëª¨ë…¸ë ˆí¬ë¡œ ìë™ íŒë‹¨ë©ë‹ˆë‹¤.
          </p>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì„œë²„ -->
        <div class="section">
          <h2 class="section-title">í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì„œë²„</h2>
          <p style="font-size: 13px; color: #718096; margin-bottom: 16px;">
            E2E/API í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë  ì„œë²„ URLì„ ì…ë ¥í•˜ì„¸ìš”. (ê°œë°œì„œë²„, Preview, ìŠ¤í…Œì´ì§• ë“±)
          </p>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div class="input-group">
              <label for="feUrl" style="display: flex; align-items: center; gap: 6px;">
                <span style="font-size: 18px;">ğŸŒ</span> í”„ë¡ íŠ¸ì—”ë“œ URL
              </label>
              <input type="text" id="feUrl" placeholder="https://dev.example.com"
                     style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
              <p style="font-size: 11px; color: #a0aec0; margin-top: 4px;">E2E í…ŒìŠ¤íŠ¸ ì‹œ ë¸Œë¼ìš°ì €ê°€ ì ‘ì†í•  URL</p>
            </div>
            <div class="input-group">
              <label for="beUrl" style="display: flex; align-items: center; gap: 6px;">
                <span style="font-size: 18px;">âš¡</span> ë°±ì—”ë“œ API URL
              </label>
              <input type="text" id="beUrl" placeholder="https://api-dev.example.com"
                     style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
              <p style="font-size: 11px; color: #a0aec0; margin-top: 4px;">API í…ŒìŠ¤íŠ¸ ì‹œ ìš”ì²­ì„ ë³´ë‚¼ URL</p>
            </div>
          </div>
        </div>

        <!-- ì¸ì¦ ë°©ì‹ -->
        <div class="section">
          <h2 class="section-title">ì¸ì¦ ë°©ì‹</h2>
          <div class="radio-group" style="flex-direction: column; gap: 16px;">
            <!-- Keycloak SSO -->
            <div class="auth-option-container" style="width: 100%;">
              <label class="radio-option" style="width: 100%; padding: 16px 20px;">
                <input type="radio" name="auth_type" value="keycloak" checked onchange="updateAuthFields()">
                <div style="flex: 1;">
                  <span style="font-weight: 600;">ğŸ” Keycloak SSO</span>
                  <p style="font-size: 12px; color: #718096; margin-top: 2px;">ID/PW + OTP ì¸ì¦</p>
                </div>
              </label>
              <div id="keycloak-fields" class="auth-fields" style="margin-top: 0; padding: 20px; background: linear-gradient(to bottom, #f7fafc, #edf2f7); border-radius: 0 0 8px 8px; border: 2px solid #e2e8f0; border-top: none; display: block;">
                <div class="input-group" style="margin-bottom: 16px;">
                  <label style="font-size: 13px; color: #4a5568; font-weight: 500;">Keycloak URL</label>
                  <input type="text" id="keycloakUrl" placeholder="https://auth.example.com/realms/my-realm"
                         style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; margin-top: 6px;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                  <div class="input-group">
                    <label style="font-size: 13px; color: #4a5568; font-weight: 500;">Username</label>
                    <input type="text" id="keycloakUsername" placeholder="test@example.com"
                           style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; margin-top: 6px;">
                  </div>
                  <div class="input-group">
                    <label style="font-size: 13px; color: #4a5568; font-weight: 500;">Password</label>
                    <input type="password" id="keycloakPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                           style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; margin-top: 6px;">
                  </div>
                </div>
                <div class="input-group" style="background: #fff; padding: 16px; border-radius: 8px; border: 1px dashed #cbd5e0;">
                  <label style="font-size: 13px; color: #4a5568; font-weight: 500; display: flex; align-items: center; gap: 6px; margin-bottom: 12px;">
                    <span style="font-size: 16px;">ğŸ“±</span> OTP ì¸ì¦ ì²˜ë¦¬
                  </label>
                  <div style="display: flex; flex-direction: column; gap: 8px;">
                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: #f7fafc; border-radius: 6px; cursor: pointer;">
                      <input type="radio" name="otp_method" value="none" checked style="accent-color: #667eea;">
                      <span style="font-size: 13px;">OTP ì—†ìŒ (í…ŒìŠ¤íŠ¸ ê³„ì •ì— OTP ë¹„í™œì„±í™”ë¨)</span>
                    </label>
                    <label style="display: flex; align-items: flex-start; gap: 8px; padding: 10px 12px; background: #f7fafc; border-radius: 6px; cursor: pointer; flex-wrap: wrap;">
                      <input type="radio" name="otp_method" value="secret" style="accent-color: #667eea; margin-top: 3px;">
                      <span style="font-size: 13px;">TOTP Secretìœ¼ë¡œ ìë™ ìƒì„±</span>
                      <input type="text" id="keycloakTotpSecret" placeholder="JBSWY3DPEHPK3PXP"
                             style="width: 100%; padding: 8px 10px; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 12px; margin-top: 6px; font-family: monospace;"
                             onclick="document.querySelector('input[value=secret]').checked = true;">
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: #f7fafc; border-radius: 6px; cursor: pointer;">
                      <input type="radio" name="otp_method" value="manual" style="accent-color: #667eea;">
                      <span style="font-size: 13px;">í…ŒìŠ¤íŠ¸ ì‹œ ìˆ˜ë™ ì…ë ¥ (ë¸Œë¼ìš°ì € ì¼ì‹œì •ì§€)</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- JWT í† í° -->
            <div class="auth-option-container" style="width: 100%;">
              <label class="radio-option" style="width: 100%; padding: 16px 20px;">
                <input type="radio" name="auth_type" value="jwt" onchange="updateAuthFields()">
                <div style="flex: 1;">
                  <span style="font-weight: 600;">ğŸ« JWT í† í°</span>
                  <p style="font-size: 12px; color: #718096; margin-top: 2px;">ë¯¸ë¦¬ ë°œê¸‰ë°›ì€ í† í° ì‚¬ìš©</p>
                </div>
              </label>
              <div id="jwt-fields" class="auth-fields" style="margin-top: 0; padding: 20px; background: linear-gradient(to bottom, #f7fafc, #edf2f7); border-radius: 0 0 8px 8px; border: 2px solid #e2e8f0; border-top: none; display: none;">
                <div class="input-group">
                  <label style="font-size: 13px; color: #4a5568; font-weight: 500;">Access Token</label>
                  <textarea id="jwtToken" placeholder="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."
                         style="width: 100%; padding: 12px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 13px; margin-top: 6px; font-family: monospace; min-height: 80px; resize: vertical;"></textarea>
                </div>
              </div>
            </div>

            <!-- ì¸ì¦ ì—†ìŒ -->
            <label class="radio-option" style="width: 100%; padding: 16px 20px;">
              <input type="radio" name="auth_type" value="none" onchange="updateAuthFields()">
              <div style="flex: 1;">
                <span style="font-weight: 600;">ğŸŒ ì¸ì¦ ì—†ìŒ</span>
                <p style="font-size: 12px; color: #718096; margin-top: 2px;">ê³µê°œ API í…ŒìŠ¤íŠ¸</p>
              </div>
            </label>
          </div>
        </div>

        <!-- ë¶„ì„ ëŒ€ìƒ (Git) -->
        <div class="section">
          <h2 class="section-title">ë¶„ì„ ëŒ€ìƒ</h2>
          <p style="font-size: 13px; color: #718096; margin-bottom: 16px;">
            ë¶„ì„í•  ì†ŒìŠ¤ì½”ë“œì˜ ë¸Œëœì¹˜ ë˜ëŠ” PRì„ ì„ íƒí•˜ì„¸ìš”.
          </p>
          <div class="radio-group" style="flex-direction: column; gap: 12px;">
            <label class="radio-option" style="width: 100%;">
              <input type="radio" name="git_target" value="current" checked>
              <span>í˜„ì¬ ë¸Œëœì¹˜</span>
              <span style="color: #718096; font-size: 12px; margin-left: auto;">í”„ë¡œì íŠ¸ì˜ í˜„ì¬ ì²´í¬ì•„ì›ƒëœ ë¸Œëœì¹˜</span>
            </label>
            <label class="radio-option" style="width: 100%; flex-wrap: wrap;">
              <input type="radio" name="git_target" value="branch">
              <span>ë¸Œëœì¹˜ ì§€ì •</span>
              <input type="text" id="branchName" name="branch_name"
                     placeholder="feature/new-login"
                     style="flex: 1; margin-left: 16px; padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 13px;"
                     onclick="document.querySelector('input[value=branch]').checked = true; updateGitTargetStyle();">
            </label>
            <label class="radio-option" style="width: 100%; flex-wrap: wrap;">
              <input type="radio" name="git_target" value="pr">
              <span>PR</span>
              <input type="text" id="prInput" name="pr_input"
                     placeholder="123 ë˜ëŠ” https://github.com/org/repo/pull/123"
                     style="flex: 1; margin-left: 16px; padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 13px;"
                     onclick="document.querySelector('input[value=pr]').checked = true; updateGitTargetStyle();">
            </label>
          </div>
          <p style="font-size: 12px; color: #718096; margin-top: 12px;">
            ğŸ’¡ PR ë²ˆí˜¸ë§Œ ì…ë ¥í•˜ë©´ í”„ë¡œì íŠ¸ ê²½ë¡œì—ì„œ Git repositoryë¥¼ ìë™ ê°ì§€í•©ë‹ˆë‹¤.
          </p>
        </div>

        <!-- ì°¸ì¡° ë¬¸ì„œ -->
        <div class="section">
          <h2 class="section-title">ì°¸ì¡° ë¬¸ì„œ</h2>
          <p style="font-size: 13px; color: #718096; margin-bottom: 16px;">
            ì‹œë‚˜ë¦¬ì˜¤ ìƒì„± ì‹œ ì°¸ì¡°í•  ë¬¸ì„œì˜ URL ë˜ëŠ” íŒŒì¼ ê²½ë¡œë¥¼ ì…ë ¥í•˜ì„¸ìš”. (ì—¬ëŸ¬ ê°œ ê°€ëŠ¥)
          </p>

          <div class="doc-list">
            <!-- ê¸°ëŠ¥ì •ì˜ì„œ -->
            <div class="doc-category" data-type="prd">
              <div class="doc-category-header" onclick="toggleCategory('prd')">
                <span class="doc-category-title">ğŸ“‹ ê¸°ëŠ¥ì •ì˜ì„œ (PRD)</span>
                <button type="button" class="add-btn" onclick="event.stopPropagation(); addDoc('prd')">+ ì¶”ê°€</button>
              </div>
              <div class="doc-items" id="prd-items">
                <p class="empty-message">Confluence, Notion URL ë˜ëŠ” ë¡œì»¬ íŒŒì¼ ê²½ë¡œ</p>
              </div>
            </div>

            <!-- API ëª…ì„¸ì„œ -->
            <div class="doc-category" data-type="api">
              <div class="doc-category-header" onclick="toggleCategory('api')">
                <span class="doc-category-title">ğŸ”Œ API ëª…ì„¸ì„œ (Swagger/OpenAPI)</span>
                <button type="button" class="add-btn" onclick="event.stopPropagation(); addDoc('api')">+ ì¶”ê°€</button>
              </div>
              <div class="doc-items" id="api-items">
                <p class="empty-message">Swagger URL, OpenAPI JSON/YAML ê²½ë¡œ</p>
              </div>
            </div>

            <!-- í™”ë©´ì„¤ê³„ì„œ -->
            <div class="doc-category" data-type="design">
              <div class="doc-category-header" onclick="toggleCategory('design')">
                <span class="doc-category-title">ğŸ¨ í™”ë©´ì„¤ê³„ì„œ (Figma/PDF)</span>
                <button type="button" class="add-btn" onclick="event.stopPropagation(); addDoc('design')">+ ì¶”ê°€</button>
              </div>
              <div class="doc-items" id="design-items">
                <p class="empty-message">Figma URL, PDF íŒŒì¼ ê²½ë¡œ</p>
              </div>
            </div>

            <!-- ì •ì±…ì„œ -->
            <div class="doc-category" data-type="policy">
              <div class="doc-category-header" onclick="toggleCategory('policy')">
                <span class="doc-category-title">ğŸ“œ ì •ì±…ì„œ (ë³´ì•ˆ/ê¶Œí•œ/ë¹„ì¦ˆë‹ˆìŠ¤)</span>
                <button type="button" class="add-btn" onclick="event.stopPropagation(); addDoc('policy')">+ ì¶”ê°€</button>
              </div>
              <div class="doc-items" id="policy-items">
                <p class="empty-message">ë³´ì•ˆ ì •ì±…, ê¶Œí•œ ì •ì±…, ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ë¬¸ì„œ</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="submit-section">
        <button type="submit" class="submit-btn">ğŸš€ ì‹œë‚˜ë¦¬ì˜¤ ìƒì„± ì‹œì‘</button>
      </div>
    </form>
  </div>

  <!-- ì„±ê³µ ëª¨ë‹¬ -->
  <div class="success-overlay" id="successOverlay">
    <div class="success-modal">
      <div class="success-icon">âœ“</div>
      <h2>ì„¤ì • ì™„ë£Œ!</h2>
      <p>ì‹œë‚˜ë¦¬ì˜¤ ìƒì„±ì´ ì‹œì‘ë©ë‹ˆë‹¤.<br>ì´ ì°½ì„ ë‹«ì•„ë„ ë©ë‹ˆë‹¤.</p>
    </div>
  </div>

  <script>
    const docs = {
      prd: [],
      api: [],
      design: [],
      policy: []
    };

    // ì¸ì¦ ë°©ì‹ì— ë”°ë¥¸ í•„ë“œ í‘œì‹œ/ìˆ¨ê¹€
    function updateAuthFields() {
      const authType = document.querySelector('input[name="auth_type"]:checked').value;
      document.getElementById('keycloak-fields').style.display = authType === 'keycloak' ? 'block' : 'none';
      document.getElementById('jwt-fields').style.display = authType === 'jwt' ? 'block' : 'none';

      // ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
      document.querySelectorAll('input[name="auth_type"]').forEach(r => {
        r.closest('.radio-option').classList.remove('selected');
      });
      const checked = document.querySelector('input[name="auth_type"]:checked');
      if (checked) {
        checked.closest('.radio-option').classList.add('selected');
      }
    }

    function toggleCategory(type) {
      const items = document.getElementById(`${type}-items`);
      items.classList.toggle('open');
    }

    function addDoc(type) {
      const items = document.getElementById(`${type}-items`);

      // ë¹ˆ ë©”ì‹œì§€ ì œê±°
      const emptyMsg = items.querySelector('.empty-message');
      if (emptyMsg) emptyMsg.remove();

      // ì¹´í…Œê³ ë¦¬ ì—´ê¸°
      items.classList.add('open');

      const index = docs[type].length;
      docs[type].push('');

      const docItem = document.createElement('div');
      docItem.className = 'doc-item';
      docItem.innerHTML = `
        <input type="text" placeholder="URL ë˜ëŠ” íŒŒì¼ ê²½ë¡œ ì…ë ¥"
               onchange="updateDoc('${type}', ${index}, this.value)"
               oninput="updateDoc('${type}', ${index}, this.value)">
        <button type="button" class="remove-btn" onclick="removeDoc('${type}', ${index}, this.parentElement)">ì‚­ì œ</button>
      `;

      items.appendChild(docItem);
      docItem.querySelector('input').focus();
    }

    function updateDoc(type, index, value) {
      docs[type][index] = value;
    }

    function removeDoc(type, index, element) {
      docs[type][index] = null;
      element.remove();

      const items = document.getElementById(`${type}-items`);
      if (items.children.length === 0) {
        const placeholders = {
          prd: 'Confluence, Notion URL ë˜ëŠ” ë¡œì»¬ íŒŒì¼ ê²½ë¡œ',
          api: 'Swagger URL, OpenAPI JSON/YAML ê²½ë¡œ',
          design: 'Figma URL, PDF íŒŒì¼ ê²½ë¡œ',
          policy: 'ë³´ì•ˆ ì •ì±…, ê¶Œí•œ ì •ì±…, ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ë¬¸ì„œ'
        };
        items.innerHTML = `<p class="empty-message">${placeholders[type]}</p>`;
      }
    }

    // ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ë§ (ì¸ì¦ ë°©ì‹)
    document.querySelectorAll('input[name="auth_type"]').forEach(radio => {
      radio.addEventListener('change', () => {
        document.querySelectorAll('input[name="auth_type"]').forEach(r => {
          r.closest('.radio-option').classList.remove('selected');
        });
        if (radio.checked) {
          radio.closest('.radio-option').classList.add('selected');
        }
      });
    });

    // Git ëŒ€ìƒ ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ë§
    function updateGitTargetStyle() {
      document.querySelectorAll('input[name="git_target"]').forEach(r => {
        r.closest('.radio-option').classList.remove('selected');
      });
      const checked = document.querySelector('input[name="git_target"]:checked');
      if (checked) {
        checked.closest('.radio-option').classList.add('selected');
      }
    }

    document.querySelectorAll('input[name="git_target"]').forEach(radio => {
      radio.addEventListener('change', updateGitTargetStyle);
    });

    // ì´ˆê¸° ì„ íƒ ìŠ¤íƒ€ì¼
    document.querySelector('input[name="auth_type"]:checked')?.closest('.radio-option')?.classList.add('selected');
    document.querySelector('input[name="git_target"]:checked')?.closest('.radio-option')?.classList.add('selected');

    // í¼ ì œì¶œ
    document.getElementById('configForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const bePath = document.getElementById('bePath').value.trim();
      const fePath = document.getElementById('fePath').value.trim();

      // í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì„œë²„
      const feUrl = document.getElementById('feUrl').value.trim();
      const beUrl = document.getElementById('beUrl').value.trim();

      const authType = document.querySelector('input[name="auth_type"]:checked').value;

      // ì¸ì¦ ì •ë³´ ìˆ˜ì§‘
      let auth = { type: authType };
      if (authType === 'keycloak') {
        auth.keycloak_url = document.getElementById('keycloakUrl').value.trim();
        auth.username = document.getElementById('keycloakUsername').value.trim();
        auth.password = document.getElementById('keycloakPassword').value.trim();

        // OTP ì²˜ë¦¬ ë°©ë²•
        const otpMethod = document.querySelector('input[name="otp_method"]:checked').value;
        auth.otp_method = otpMethod;
        if (otpMethod === 'secret') {
          auth.totp_secret = document.getElementById('keycloakTotpSecret').value.trim();
        }
      } else if (authType === 'jwt') {
        auth.token = document.getElementById('jwtToken').value.trim();
      }

      // Git ëŒ€ìƒ ì •ë³´
      const gitTargetType = document.querySelector('input[name="git_target"]:checked').value;
      const branchName = document.getElementById('branchName').value.trim();
      const prInput = document.getElementById('prInput').value.trim();

      // ë¬¸ì„œ ëª©ë¡ ì •ë¦¬ (null, ë¹ˆ ë¬¸ìì—´ ì œê±°)
      const cleanDocs = (arr) => arr.filter(d => d && d.trim());

      // Git ëŒ€ìƒ ê°ì²´ ìƒì„±
      let gitTarget = { type: gitTargetType };
      if (gitTargetType === 'branch' && branchName) {
        gitTarget.branch = branchName;
      } else if (gitTargetType === 'pr' && prInput) {
        // URLì¸ì§€ ë²ˆí˜¸ì¸ì§€ íŒë‹¨
        if (prInput.startsWith('http')) {
          gitTarget.pr_url = prInput;
        } else {
          gitTarget.pr_number = prInput;
        }
      }

      const config = {
        be_path: bePath,
        fe_path: fePath || null,
        test_server: {
          fe_url: feUrl || null,
          be_url: beUrl || null
        },
        auth: auth,
        project_type: (bePath === fePath && fePath) ? 'monorepo' : (fePath ? 'separated' : 'api_only'),
        git_target: gitTarget,
        documents: {
          prd: cleanDocs(docs.prd),
          api: cleanDocs(docs.api),
          design: cleanDocs(docs.design),
          policy: cleanDocs(docs.policy)
        }
      };

      try {
        const response = await fetch('/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(config)
        });

        if (response.ok) {
          document.getElementById('successOverlay').classList.add('show');
        }
      } catch (err) {
        alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + err.message);
      }
    });
  </script>
</body>
</html>
